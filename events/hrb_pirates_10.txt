namespace = hrb_pirates

@pirates_mean_time_to_happen = 5475 # ~ 15 years ~ 2359

#PIRACY TRIGGERING EVENT
country_event = {
	id = hrb_pirates.10
	hide_window = yes
	fire_only_once = yes

	mean_time_to_happen = { days = @pirates_mean_time_to_happen }

	trigger = {
		is_ai = no
		num_starbases >= 21
	}

	immediate = {
		create_hrb_pirate_country = yes
		last_created_country = {
			save_global_event_target_as = hrb_pirate_country
		}

		#Pick a system to spawn the Dreadnought
		random_system = {
			limit = {
				NOR = { 
					exists = owner
					has_presence = yes
				any_system_planet = {
					is_star_class = sc_highway_node
					}
				}
			}
			save_event_target_as = dreadnought_spawn_system
			log = "Dreadnought spawn point is [dreadnought_spawn_system.GetName]"
		}
		event_target:dreadnought_spawn_system = {
			random_system_planet = {
				limit = { is_star = yes }
				save_event_target_as = dreadnought_spawn_star
			}
		}

		#Pick a system to spawn the Redoubt, has to be another one
		random_system = {
			limit = {
				NOR = {
					has_presence = yes
					exists = owner
					is_same_value = event_target:dreadnought_spawn_system
					any_system_planet = {
						is_star_class = sc_highway_node
					}
				}
			}
			save_global_event_target_as = redoubt_spawn_system
			log = "Redoubt spawn point is [redoubt_spawn_system.GetName]"
		}
		event_target:redoubt_spawn_system = {
			random_system_planet = {
				limit = { is_star = yes }
				save_global_event_target_as = redoubt_spawn_star
			}
		}

		# Triggers THE DAWN OF INTERSTELLAR PIRACY pop-up
		every_country = {
			limit = {
				is_ai = no
			}
			country_event = { id = hrb_pirates.20 days = 1 }
		}
		
		
		# Initialize the Dreadnought only once
		if = {
			limit = {
				exists = event_target:dreadnought_spawn_system
			}
			country_event = { id = hrb_pirates.30 }
		}

		# Initialize the Redoubt only once
		if = {
			limit = {
				exists = event_target:redoubt_spawn_system
			}
			country_event = { id = hrb_pirates.40 }
		}
	}
}